\documentclass[../Moduli_Spaces_of_Riemann_Surfaces.tex]{subfiles}
\begin{document}
    \section{Sheaves and Function Germs}
    Unless otherwise stated, in this section, $X$ denotes a topological space with $\mc{T}$ its system of open sets. Our exposition on sheaves roughly follows \cite[][Section 6]{forster} and \cite[][Chapter IX]{miranda}.
    \subsection{Presheaves and Sheaves}
    \begin{definition}
        A \uldef{presheaf of Abelian groups on $X$} is a pair $\tpl{\ms{F},\rho}$ consisting of
        \begin{itemize}
            \item a family $\ms{F}\coloneqq\l\{\ms{F}\l(U\r)\r\}$ of Abelian groups $\ms{F}\l(U\r)$ for every $U\in\mc{T}$,
                \vspace{-0.05in}
            \item a family $\rho\coloneqq\l\{\rho^U_V\r\}$ of group homomorphisms $\rho^U_V:\ms{F}\l(U\r)\to\ms{F}\l(V\r)$ for every $U,V\in\mc{T}$ with $V\subseteq U$,
        \end{itemize}
        such that the following two properties hold:
        \begin{itemize}
            \item For every $U\in\mc{T}$, we have $\rho^U_U=\id_{\ms{F}\l(U\r)}$.
                \vspace{-0.05in}
            \item For every $U,V,W\in\mc{T}$ with $W\subseteq V\subseteq U$, we have $\rho^V_W\circ\rho^U_V=\rho^U_W$.
        \end{itemize}
    \end{definition}
    \begin{remark}\side[-1.36in]{Analogously, we define the presheaf of sets, rings, vector spaces, algebras, etc, on a topological space $X$.\\\ \\For those with some category theory background, fix any category $\cat{C}$. A \ul{$\cat{C}$-valued presheaf on $X$} is simply a contravariant functor $\ms{F}:\mc{T}\to\cat{C}$ where $\mc{T}$ is the preorder category induced by $\tpl{\mc{T},\subseteq}$.}
        Presheaves give us a way of tracking data associated with open sets of a topological space in such a way that makes restricting to a smaller open set $V\subseteq U$ well-behaved. Consider, for instance, a Riemann surface $X$ and the presheaf of all holomorphic functions $\HOLO$ on $X$.
        \begin{itemize}
            \item To every open set $U\subseteq X$\side{Similarly, consider the (multiplicative) group $\HOLO^\ast\!\l(U\r)$ of all holomorphic functions $f:U\to\C^\ast$, which defines a presheaf $\HOLO^\ast$ of Abelian groups. We define $\MERO^\ast\!\l(U\r)$ similarly, but instead restrict to all meromorphic functions $f:U\to\C$ that do not vanish identically on any connected-component of $U$.} we consider the $\C$-algebra $\HOLO\l(U\r)$ of all holomorphic functions $f:U\to\C$. For any open $V\subseteq U$, we define $\rho^U_V\!\l(f\r)\coloneqq\l.f\r|_V$. The two properties are then trivial, which respectively states that restricting to the domain does nothing, and that restricting once to $V$ and then to $W\subseteq V$ yields the same function as restricting to $W$ directly.
        \end{itemize}
        Similarly, we have the presheaf of all meromorphic functions $\MERO$ on $X$. However, those two examples are much more than presheaves since global information about elements in $\ms{F}\l(X\r)$ can be obtained locally by `restricting' to $U$. The notion of a sheaf makes this precise.\exqed
    \end{remark}
    \begin{definition}
        A presheaf $\ms{F}$ on $X$ is said to be a \uldef{sheaf} if for every open set $U\subseteq X$ and every family $\l\{U_i\r\}_{i\in I}$ of open subsets that cover $U$, the following two properties hold:
        \begin{itemize}
            \item (Identity): For every $f,g\in\ms{F}\l(U\r)$, if $\rho^U_{U_i}\!\l(f\r)=\rho^U_{U_i}\!\l(g\r)$ for every $i\in I$, then $f=g$.
                \vspace{-0.05in}
            \item (Gluing): For every family $\l\{f_i\r\}_{i\in I}$ with $f_i\in\ms{F}\l(U_i\r)$, if $\rho^{U_i}_{U_i\cap U_j}\!\l(f_i\r)=\rho^{U_j}_{U_i\cap U_j}\!\l(f_j\r)$ for all $i,j\in I$, then there is a function $f\in\ms{F}\l(U\r)$ such that $\rho^U_{U_i}\!\l(f\r)=f_i$ for every $i\in I$.
        \end{itemize}
    \end{definition}
    \side[-1in]{It is immediate that $\HOLO$, $\HOLO^\ast$, $\MERO$, and $\MERO^\ast$ are all sheaves on $X$. Indeed, if we have a family $\l\{f_i\r\}$ that agree on all pairwise common domains, then there exists a globally defined function $f$ whose restrictions are $f_i$'s. We only need to show that this globally defined function is of the `right type', but this can be checked easily.}
    \vspace{-0.05in}
    \begin{example}
        We give an example of a presheaf that is \textit{not} a sheaf. Let $X$ be a normed vector space. For all $U\subseteq X$, let $\ms{B}\l(U\r)$ be the vector space of all bounded functions $f:U\to\R$.
        \begin{itemize}
            \item It is clear from our remarks above that $\ms{B}$ is a presheaf. In fact, since $\ms{B}\l(U\r)$ contains functions, we see that if $f,g\in\ms{B}\l(U\r)$ agree on all restrictions, then they agree on $U$.
        \end{itemize}
        The problem arises when we consider glueing. For instance, let $U_i\coloneqq\l\{p\in X\mid\l\|p\r\|<i\r\}$ and observe that $\l\{U_i\r\}_{i\in\R^+}$ covers $X$. Consider the family $\l\{f_i\r\}$ where each $f_i\coloneqq\id_{U_i}$, which clearly agree on their pairwise intersections. But no function $f:X\to\R$ such that $\l.f\r|_{U_i}=f_i$ for all $i\in\R^+$ can be bounded, so $\ms{B}$ is not a sheaf.\exqed
    \end{example}
    \begin{example}
        We give two examples of sheaves relating to \textit{divisors}\side[0.01in]{For compact Riemann surfaces, we see that a function $D:X\to\Z$ is a divisor iff it has finite support, so its set of divisors is the free Abelian group of the points of $X$.} on a Riemann surface $X$; that is, a function $D:X\to\Z$ whose support $\l\{p\in X\mid D\l(p\r)\neq0\r\}$ is a discrete subset of $X$.
        \begin{itemize}
            \item Let $D$ be a divisor on $X$. For every $U\in\mc{T}$, let $\HOLO\l[D\r]\l(U\r)$ denote the set of all meromorphic functions $f:X\to\C$ such that $\ord_p\!\l(f\r)\leq D\l(p\r)$ for all $p\in X$. The usual restriction homomorphisms make $\HOLO\l[D\r]$ is a sheaf of Abelian groups, \side[0.01in]{This construction generalizes both $\HOLO$ and $\MERO$. Indeed, $\HOLO=\HOLO\l[0\r]$ and $\MERO=\bigsqcup_{D\neq0}\HOLO\l[D\r]$. Intuitively, the use of divisors here allow us to `bound' the orders of the poles of $f$ at specific points $p$, thereby restricting how badly-behaved it can be.} for if $\l\{f_i\r\}$ is a family of meromorphic functions having poles bounded by $D$, then the meromorphic function $f:X\to\C$ that glues them together also has poles bounded by $D$.
            \item For every $U\in\mc{T}$, let $\ms{D}\l(U\r)$ denote the group of all discretely-supported functions from $U$ to $\Z$ (which is exactly a divisor on $U$). This makes $\ms{D}$ into a sheaf since for every family $\l\{D_i\r\}$, the function $D:X\to\Z$ that glues them together is also discretely-supported.\exqed
        \end{itemize}
    \end{example}
    \begin{definition}
        Let $\tpl{\ms{F},\rho}$ and $\tpl{\ms{G},\sigma}$ be two sheaves of Abelian groups on $X$. A \uldef{morphism} \uldef{of sheaves} $\eta:\ms{F}\to\ms{G}$ is a family $\l\{\eta_U\r\}_{U\in\mc{T}}$ of group homomorphisms $\eta_U:\ms{F}\l(U\r)\to\ms{G}\l(U\r)$ such that for every $U\in\mc{T}$ and every open set $V\subseteq U$, the following diagram commutes.
        \begin{equation*}
            \begin{tikzcd}
                \ms{F}\l(U\r) \ar[r, "\eta_U"] \ar[d, "\rho^U_V"'] & \ms{G}\l(U\r) \ar[d, "\sigma^U_V"] \\
                \ms{F}\l(V\r) \ar[r, "\eta_V"] & \ms{G}\l(V\r)
            \end{tikzcd}
        \end{equation*}
    \end{definition}
    \side[-1.15in]{Phrased categorically, a morphism of sheaves is simply a natural transformation $\eta:\ms{F}\Rightarrow\ms{G}$. This makes the collection of all sheaves on $X$ into a category.}
    \begin{example}
        Some examples relating to divisors of a Riemann surface $X$.
        \begin{itemize}
            \item For divisors $D_1$ and $D_2$ of a Riemann surface $X$, we write $D_1\leq D_2$ if $D_1\!\l(p\r)\leq D_2\!\l(p\r)$ for all $p\in X$. This induces an \textit{inclusion morphism} $\iota:\HOLO\l[D_1\r]\into\HOLO\l[D_2\r]$ defined\side{In particular, we have the inclusion $\HOLO\into\MERO$.} by $\iota_U\!\l(f\r)\coloneqq f$ for all $U\in\mc{T}$ and $f\in\HOLO\l[D_1\r]\l(U\r)$, which makes sense since if $D_1\leq D_2$ and the poles of $f$ are bounded by $D_1$, then they are also clearly bounded by $D_2$. This inclusion also respect restrictions, so it is indeed a morphism of sheaves.
            \item For all $U\in\mc{T}$, we associate to each $f\in\MERO^\ast\!\l(U\r)$ the divisor $\div f:U\to\Z:p\mapsto\ord_p\!\l(f\r)$\side{Such a function $\div f$ is a divisor by discreteness of zeros and poles.}. This induces a morphism of sheaves $\div:\MERO^\ast\to\ms{D}$ since for all $U\in\mc{T}$ and all open sets $V\subseteq U$, the restriction of the divisor of any $f\in\MERO^\ast\!\l(U\r)$ coincides with the divisor of the restriction $\l.f\r|_V$.\exqed
        \end{itemize}
    \end{example}
    \subsection{Stalks and the Étalé Space}
    Throughout this section, $p\in X$ is a fixed point in a topological space $X$.
    \begin{definition}
        Let $\ms{F}$ be a presheaf of Abelian groups on $X$. The \uldef{stalk of $\ms{F}$ at $p$} is the Abelian group
        \begin{equation*}
            \ms{F}_p\coloneqq\raisebox{-2pt}{$\Biggl(\!$}\bigsqcup_{U\ni p}\ms{F}\l(U\r)\!\raisebox{-2pt}{$\Biggr)$}\!\!_{\scalebox{2}{/}\sim_p}
        \end{equation*}
        where $\sim_p$ is the equivalence relation on the disjoint union, defined, for all $f\in\ms{F}\l(U\r)$ and $g\in\ms{F}\l(V\r)$, by $f\sim_p g$ iff there exists an open set $W\in\mc{T}$ with $p\in W\subseteq U\cap V$ such that $\rho^U_W\!\l(f\r)=\rho^V_W\!\l(g\r)$. For any $f\in\ms{F}\l(U\r)$, its equivalence class $\l[f\r]_p$ is called the \uldef{germ of $f$ at $p$}.
    \end{definition}
    \begin{example}
        Let\side[-1.23in]{This construction is analogous to that of the \textit{tangent space} $T_pM$ of a (real) manifold $M$ at some point $p$.}\side[0.01in]{This equivalence relation allows us to `evaluate' a function germ $\eta\in\HOLO_p\!\l[D\r]$ as $\eta\l(p\r)\coloneqq f\l(p\r)$ where $U\ni p$ is any open set and $f\in\HOLO\l[D\r]\l(U\r)$ is any function such that $\eta=\l[f\r]_p$.} $D$ be a divisor on a Riemann surface $X$ and consider the stalk $\HOLO_p\!\l[D\r]$. Fix a chart centered at $p$. Since any meromorphic function $f$ admits a Laurent series, we see that the function germ $\l[f\r]_p$ is represented by a Laurent series $\sum_{i=i_0}^{\infty}c_iz^i$ for some $i_0\geq-D\l(p\r)$ and $c_i\in\C$. Conversely, the germ of any Laurent series $\sum_{i=i_0}^{\infty}c_iz^i$ with $i_0\geq-D\l(p\r)$ and $c_0\in\C$ lifts to a meromorphic function germ $\l[f\r]_p$, so this defines a bijection\side[0.01in]{This isomorphism depends on the chosen chart map, so it is not canonical.} between $\HOLO_p\!\l[D\r]$ and the set of all such Laurent series.\exqed
    \end{example}
    \begin{remark}
        The sheaf axioms guarantee that if $\ms{F}$ is a sheaf of Abelian groups on $X$ and $U\in\mc{T}$, then an element $f\in\ms{F}\l(U\r)$ is zero iff\side{The forward direction is tautological.} all germs $\l[f\r]_p$, for $p\in U$ vanish. Indeed, let $0\in\ms{F}\l(U\r)$ denote the zero element, so $f\sim_p0$ for all $p\in U$ furnishes a family $\l\{W_p\r\}$ of open sets $W_p\subseteq U$ containing $p$ such that $\rho^U_{W_p}\!\l(f\r)=\rho^U_{W_p}\!\l(0\r)$. This family covers $U$, so $f=0$ by the first sheaf axiom.\exqed
    \end{remark}
    \begin{proposition}\label{2.2:prp:basis_stalk}
        Let $\ms{F}$ be a presheaf of Abelian groups on $X$. Let $\l|\ms{F}\r|\coloneqq\bigsqcup_{p\in X}\ms{F}_p$ and consider the projection $\pi:\l|\ms{F}\r|\to X$ mapping each $\eta\in\ms{F}_p$ to $p$. Then the system $\mc{B}$ of all sets
        \begin{equation*}
            \l[U,f\r]\coloneqq\bigl\{\l[f\r]_p\,\l|\,p\in U\bigr\}\r.\subseteq\l|\ms{F}\r|
        \end{equation*}
        for $U\in\mc{T}$ and $f\in\ms{F}\l(U\r)$ is a basis for a topology on $\l|\ms{F}\r|$ and $\pi$ is a local homeomorphism.
    \end{proposition}
    \begin{proof}
        We first verify that $\mc{B}$ is a basis.
        \begin{enumerate}
            \item[(a)] Take $\eta\in\l|\ms{F}\r|$, so there exists an open set $U\in\mc{T}$ such that $\eta=\l[f\r]_p$ for some $f\in\ms{F}\l(U\r)$ and $p\in U$. Observe that $\eta\in\l[U,f\r]$.
            \item[(b)] Take $\l[U,f\r],\l[V,g\r]\in\mc{B}$ and $\eta\in\l[U,f\r]\cap\l[V,g\r]$. Then there exists a point $p\in X$ such that $\eta=\l[f\r]_p=\l[g\r]_p$, which furnishes an open set $W\in\mc{T}$ with $p\in W\subseteq U\cap V$ such that $\rho^U_W\!\l(f\r)=\rho^V_W\!\l(g\r)\eqqcolon h$. Then $\eta=\l[h\r]_p$ with $h\in W$, so $\eta\in\l[W,h\r]\subseteq\l[U,f\r]\cap\l[V,g\r]$.
        \end{enumerate}
        To show that $\pi$ is a local homeomorphism, fix $\eta\in\l|\ms{F}\r|$, say with $p\coloneqq\pi\l(\eta\r)$. By (a), there exists some $\l[U,f\r]\in\mc{B}$ containing $\eta$; we claim that $\l.\pi\r|_{\l[U,f\r]}:\l[U,f\r]\to U$ is a homeomorphism.
        \begin{itemize}
            \item For injectivity, take $\psi_1,\psi_2\in\l[U,f\r]$ such that $\pi\l(\psi_1\r)=\pi\l(\psi_2\r)$. Then $\psi_1=\l[f\r]_p$ and $\psi_2=\l[f\r]_q$ for some $p,q\in X$, but since $p=q$, they coincide.
            \item For continuity, it suffices to show that $\l.\pi\r|_{\l[U,f\r]}$ is an open map. Indeed, if $\l[V,g\r]\subseteq\l[U,f\r]$ is open, then $\l.\pi\r|_{\l[U,f\r]}\l(\l[V,g\r]\r)=V$ is open too.\qed
        \end{itemize}
    \end{proof}
    \begin{definition}
        The \uldef{Étalé space} of a presheaf $\ms{F}$ of Abelian groups on $X$ is the topological space $\l|\ms{F}\r|$ equipped the projection $\pi:\l|\ms{F}\r|\to X$.
    \end{definition}
    \begin{definition}
        A presheaf $\ms{F}$ of Abelian groups on $X$ is said to satisfy the \uldef{Identity Theorem} if for all $U\in\mc{T}$, any two elements $f,g\in\ms{F}\l(U\r)$ such that $\l[f\r]_p=\l[g\r]_p$ for some $p\in U$ coincides.
    \end{definition}
    \side[-0.4in]{In particular, this holds for all $\HOLO\l[D\r]$.}
    \begin{proposition}\label{2.2:prp:stalk_topology_Hausdorff}
        If $X$ is a locally-connected Hausdorff space and $\ms{F}$ is a presheaf of Abelian groups on $X$ that satisfy the Identity Theorem, then $\l|\ms{F}\r|$ is Hausdorff.
    \end{proposition}
    \begin{proof}
        Take distinct $\eta_1,\eta_2\in\l|\ms{F}\r|$. Two cases occur.
        \begin{itemize}
            \item If $p\coloneqq\pi\l(\eta_1\r)\neq\pi\l(\eta_2\r)\eqqcolon q$, then, since $X$ is Hausdorff, there exist disjoint neighborhoods $U$ of $p$ and $V$ of $q$. On those neighborhoods, $\pi$ is invertible and the sets $\pi^{-1}\!\l(U\r)$ and $\pi^{-1}\!\l(V\r)$ are disjoint neighborhoods of $\eta_1$ and $\eta_2$, respectively.
        \end{itemize}
        Otherwise, set $p\coloneqq\pi\l(\eta_1\r)=\pi\l(\eta_2\r)$ and suppose that each $\eta_i$ is represented by some $f_i\in\ms{F}\l(U_i\r)$. Since $X$ is locally-connected, there exists a connected neighborhood $U\subseteq U_1\cap U_2$ of $p$. Restricting both $f_i$ to $g_i\coloneqq\rho^{U_i}_U\!\l(f_i\r)$, the sets $\l[U,g_i\r]$ are neighborhoods of $\eta_i$. Suppose, for sake of contradiction, that there exists some $\psi\in\l[U,g_1\r]\cap\l[U,g_2\r]$. Setting $q\coloneqq\pi\l(\psi\r)$, we see that $\psi=\l[g_1\r]_q=\l[g_2\r]_q$, from which the Identity Theorem shows that $g_1=g_2$. Note that $f_i\sim_pg_i$, so $\eta_1=\eta_2$, a contradiction. Hence the neighborhoods $\l[U,g_1\r]$ an $\l[U,g_2\r]$ are disjoint, as desired.\qed
    \end{proof}
\end{document}
